CREATE DATABASE IF NOT EXISTS cinema_db;
USE cinema_db;

CREATE TABLE IF NOT EXISTS clientes (
    id_cliente INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    telefone VARCHAR(20),
    senha VARCHAR(100) NOT NULL,
    is_admin BOOLEAN DEFAULT FALSE
);

INSERT IGNORE INTO clientes (nome, email, telefone, senha, is_admin) 
VALUES ('Administrador', 'admin@cinema.com', '00000000', '123', 1);

CREATE TABLE IF NOT EXISTS salas (
    id_sala INT AUTO_INCREMENT PRIMARY KEY,
    numero_sala INT NOT NULL,
    capacidade INT NOT NULL
);

CREATE TABLE IF NOT EXISTS filmes (
    id_filme INT AUTO_INCREMENT PRIMARY KEY,
    titulo VARCHAR(150) NOT NULL,
    duracao INT NOT NULL,
    classificacao VARCHAR(10),
    genero VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS sessoes (
    id_sessao INT AUTO_INCREMENT PRIMARY KEY,
    data_hora DATETIME NOT NULL,
    id_filme INT NOT NULL,
    id_sala INT NOT NULL,
    FOREIGN KEY (id_filme) REFERENCES filmes(id_filme),
    FOREIGN KEY (id_sala) REFERENCES salas(id_sala)
);

CREATE TABLE IF NOT EXISTS ingressos (
    id_ingresso INT AUTO_INCREMENT PRIMARY KEY,
    assento VARCHAR(5) NOT NULL,
    valor DECIMAL(10, 2) NOT NULL,
    id_cliente INT NOT NULL,
    id_sessao INT NOT NULL,
    FOREIGN KEY (id_cliente) REFERENCES clientes(id_cliente),
    FOREIGN KEY (id_sessao) REFERENCES sessoes(id_sessao),
    UNIQUE KEY unique_assento_sessao (id_sessao, assento)
);